/*2013/11/19-http://nolure.github.io/nojs.docs*/define("main",["nojs/module/tree","nojs/module/codelight","project","./a"],function(require,a,b){function c(a,b){var d,e,f=location.hash.replace(/^#/,"").split("&"),g={};for(a=a||"id",d=0;d<f.length;d++)f[d]&&(e=f[d].split("="),g[e[0]]=e[1]);if(b==g[a])return g[a];if(null===b)delete g[a];else{if(void 0===b)return g[a];g[a]=b,c.key=a}f=[];for(d in g)f.push(d+"="+g[d]);v=1,location.hash=f.join("&")}function d(){var a=p.height()-x;t.height(a)}function e(b,c){var d,e,f=c.data;if(f){e="menu_"+b,d=a('<div id="'+e+'" class="nj_tree"></div>'),s.append(d);var h=new g(e,{openAll:"nojs"==b?!1:!0,data:f,max:5,onSelect:w.onSelect,defaultNode:w.defaultNode});"nojs"==b&&(k=h),j.project.push(h)}}function f(a){a&&u.is(":hidden")||(a||(a="show"==f.display?"hide":"show"),"show"==a?(s.css("left","0"),f.display="show"):(s.css("left","-15em").removeAttr("style"),f.display="hide"))}var g=require("nojs/module/tree"),h=require("nojs/module/codelight"),i=require("project"),j={};require("./a");var k,l=a("#ui_page"),m=(a("#main_content"),a("#ui_head")),n=m.find(".options"),o={container:a("#demo_content").css("opacity","0"),isOpen:null},p=a(window),q="mobile"==window.Page?"mb_intro":"nojs_info",r=a("#iframe_content"),s=a("#side_menu"),t=l.children("div.ui_wrap"),u=a("#show_menu"),v=0;c.key="id",o.openFirst=void 0!=c("demo"),"undefined"!=typeof onhashchange&&(window.onhashchange=function(){var a,b,d=c(),e=c.key;if(d&&"id"==e)for(a=0;a<j.project.length;a++)if(b=j.project[a],b.data.all[d]){v=0,b.select(d);break}"demo"==e&&o.tab&&o.isOpen&&c("demo")!=o.index&&o.tab.change(c("demo"))}),a(window).bind("popstate",function(){});var w={defaultNode:c()||q,onSelect:function(d){var e=d.link,g=d.id;if(o.hide(),c("id",g),!(v>0)){if(!e)return n.hide(),void 0;window.demoAction=o.init=o.tab=null,r.html('<i class="load"></i>'),new b.ico(r.find("i.load"),{type:"loading",width:32,height:32}),l.siblings().remove();var i=this.box[0].id,k=i.substring(i.indexOf("_")+1,i.length),m="project/"+k+"/"+e+".html";"project"!=g&&this.box.siblings(".nj_tree").find("a.current").removeClass("current"),r.load(m,function(){n[window.demoAction?"show":"hide"](),window.demoAction&&(o.container.html(o.getHtml()),o.openFirst&&o.show(c("demo"))),new h({parent:r}),r.click(function(b){var c,d,e,f=b.target;if("a"==f.tagName.toLowerCase()){if(c=a(f).attr("data-action"),"demo"==c)return o.show(a(f).attr("data-index")-1),!1;if(c=a(f).attr("data-id")){for(e=0;e<j.project.length;e++)if(d=j.project[e],d.data.all[c]){d.select(c);break}return!1}}}),b.init(r)}),u.is(":visible")&&f("hide")}}},x=m.outerHeight();d(),p.on("scroll resize",d),o.getHtml=function(){if(!demoAction||!demoAction.item)return"";var a,b="",c=demoAction.item.length;if(b=['<div class="demo_wrap">','<div class="demo_head">','<a href="" data-action="back" class="nj_btn">返回</a>','<a href="" data-action="source" class="nj_btn n_b_sb">获取示例源码</a>',"</div>",demoAction.html||""].join(""),c){for(b+='<ul class="nj_s_menu clearfix">',a=0;c>a;a++)b+='<li class="nj_s_m">demo'+(a+1)+"</li>";for(b+="</ul>",b+='<div class="nj_s_con">',a=0;c>a;a++)b+='<div class="nj_s_c">'+(demoAction.item[a].content||"")+"</div>";b+="</div>"}return b+="</div>"},o.show=function(a){a=parseInt(a||0);var b=n.find("a[data-action=demo]");o.index=a,!o.isOpen&&b.click(),o.tab.change(a)},o.hide=function(){var a=n.find("a[data-action=demo]");o.isOpen&&a.click()},n.click(function(d){var e,f,g=d.target;if("a"==g.tagName.toLowerCase()){if(e=a(g),f=e.attr("data-action"),r.is(":animated"))return!1;switch(f){case"demo":o.isOpen=o.isOpen?!1:!0,o.container.animate({opacity:o.isOpen?1:0,left:o.isOpen?0:"100%"},o.openFirst?0:500,"easeOutExpo",function(){o.isOpen&&(window.demoAction&&demoAction.onShow&&demoAction.onShow(),demoAction.onChange&&demoAction.onChange(o.index))}),r.animate({opacity:o.isOpen?0:1,"margin-left":o.isOpen?"-200px":"0"},o.openFirst?0:500,"easeOutExpo"),o.isOpen&&!o.init&&(o.init=!0,o.tab=new b.Switch(o.container,{firstIndex:o.index,mode:"click",onChange:function(a){var b,d=this.con.eq(a);o.index=a,b=demoAction.item[a].callback,b&&(b.onShow&&b.onShow(),b.onChange&&b.onChange(a)),d.data("init")||(d.data("init",!0),b&&(b(b),b.index=a)),demoAction.onChange&&demoAction.onChange(a),c("demo",o.index)},onHide:function(a){var b=demoAction.item[a].callback;b&&b.onHide&&b.onHide(a)}}),window.demoAction.callback&&window.demoAction.callback()),!o.isOpen&&window.demoAction&&demoAction.onHide&&demoAction.onHide(),c("demo",o.isOpen?o.index:null),o.openFirst&&delete o.openFirst}return!1}}),o.container.click(function(b){var c,d,e=b.target;if("a"==e.tagName.toLowerCase()){if(c=a(e),d=c.attr("data-action"),"back"==d)return o.hide(),!1;if("source"==d)return o.source.show(c),!1}}),o.source=function(){function a(){d=new b.popup({width:"85%"}),d.element.css("max-width","900px"),e.data("win",d)}function c(a){if(a="function"==typeof a?a.toString().replace(/^function\s*\([^\(\)]*\)\s*{/,"").replace(/\s*}$/,"\n").replace(/\t/g,"    ").replace(/[\s\r\n]*(\/\/)(\*\*)(hide)[\s\S]*\1\3\2[\s\r\n]*/g,"\n"):"",a.length>4){var b=a.length-a.replace(/(^\s*)/,"").length;b=4*Math.floor(b/4),a=a.replace(new RegExp("(\\n\\s{"+b+"})","g"),"\n")}return a}var d,e;return{show:function(b){d=b.data("win"),e=b,!d&&a();var f,g=demoAction.item[o.index],i=['<div style="height:500px;overflow:auto"><script type="text/templete" code="html">',"<!DOCTYPE html>","<html>","<head>",'<meta charset="utf-8" />',"<title>"+k.selected+"示例"+(o.index+1)+"- nojs</title>",'<base href="http://nolure.github.io/nojs.docs/" />','<link rel="stylesheet" href="css/ui.css" />','<link rel="stylesheet" href="css/base.css" />','<link rel="stylesheet" href="css/main.css" />','<script src="src/nojs/noJS.js" data-config="global:[\'nojs/jquery\',\'nojs/ui\']" id="nojs"></ script>',"</head>","<body>",demoAction.html?demoAction.html.replace(/^\n*/,""):"",g.content?g.content.replace(/^\n*/,""):"","<script>"+c(g.callback||demoAction.callback)+"</ script>","</body>","</html>","</script></div>"];d.set("title",k.selected+" - 示例"+(o.index+1)+"源码"),d.set("content",i.join("\n")),f=new h({parent:d.content}),d.show()}}}(),j.project=[],s.empty(),g.key={name:"text",children:"data"};for(var y in i)"mobile"==window.Page&&"mobile"!=y||"mobile"!=window.Page&&"mobile"==y||e(y,i[y]);u.click(function(){return f(),!1}),f.display="hide";var z=a('<div class="f_link"></div>').appendTo(s);return"mobile"==window.Page?(z.append('<a href="index.html">nojs</a>'),l.swipeRight(function(){f("show")}).swipeLeft(function(){f("hide")})):z.append('<a href="m.html">nojs mobile</a>'),j}),define("a",[],function(){});