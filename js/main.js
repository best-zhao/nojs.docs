/*nolure@vip.qq.com|http://nolure.github.io/nojs.docs*/define("main",["nojs/module/tree","nojs/module/codelight","project"],function(require,a,b){function c(a){var b=location.href.split("#"),c=b[1];return void 0==a?c:(location.href=b[0]+"#"+a,void 0)}function d(){var a=m.height()-u;q.height(a)}function e(b,c){var d,e,f=c.data;if(f){e="menu_"+b,d=a('<div id="'+e+'" class="nj_tree"></div>'),p.append(d);var h=new g(e,{openAll:"nojs"==b?!1:!0,data:f,onSelect:t.onSelect,defaultNode:t.defaultNode});j.project.push(h)}}function f(a){a&&r.is(":hidden")||(a||(a="show"==f.display?"hide":"show"),"show"==a?(p.css("left","0"),k.css("padding-left","14em"),f.display="show"):(p.css("left","-15em"),k.css("padding-left","0"),f.display="hide"))}var g=require("nojs/module/tree"),h=require("nojs/module/codelight"),i=require("project"),j={},k=a("#ui_page"),l=(a("#main_content"),a("#ui_head")),m=a(window),n="mobile"==window.Page?"mb_intro":"nojs_info",k=a("#ui_page"),o=a("#iframe_content"),p=a("#side_menu"),q=k.children("div.ui_wrap"),r=a("#show_menu"),s=!0;"undefined"!=typeof onhashchange&&(window.onhashchange=function(){var a,b,c=location.hash;if(c=c.substring(1,c.length),c&&s)for(a=0;a<j.project.length;a++)if(b=j.project[a],b.data.all[c]){b.select(c);break}}),a(window).bind("popstate",function(){});var t={defaultNode:c()||n,onSelect:function(a){var d=a.link,e=a.id;if(c(e),s=null,d){o.html('<i class="load"></i>'),new b.ico(o.find("i.load"),{type:"loading",width:32,height:32});var g=this.box[0].id,i=g.substring(g.indexOf("_")+1,g.length),k="project/"+i+"/"+d+".html";"project"!=e&&this.box.siblings(".nj_tree").find("a.current").removeClass("current"),o.load(k,function(){new h({parent:o}),o.find("#about_link,.about_link").on("click",function(a){var b,c,d=a.target;if("a"==d.tagName.toLowerCase()){for(b=0;b<j.project.length;b++)if(c=j.project[b],c.data.all[d.id]){c.select(d.id);break}return!1}}),b.init(o)}),r.is(":visible")&&f("hide")}}};j.init=function(){var b=a('<a href="" class="add_project">添加其他项目文档</a>');b.click(function(){return t.onSelect("project","p/project.html"),!1})};var u=l.outerHeight();d(),m.on("scroll resize",d),j.project=[],p.empty(),g.key={name:"text",children:"data"};for(var v in i)"mobile"==window.Page&&"mobile"!=v||"mobile"!=window.Page&&"mobile"==v||e(v,i[v]);r.click(function(){return f(),!1}),f.display="hide";var w=a('<div class="f_link"></div>').appendTo(p);return"mobile"==window.Page?(w.append('<a href="index.html">nojs</a>'),k.swipeRight(function(){f("show")}).swipeLeft(function(){f("hide")})):w.append('<a href="m.html">nojs mobile</a>'),w.append('<a href="http://nolure.com">blog: http://nolure.com</a>'),j}),define([],function(require,a){function b(c,d){if(+new Date,this.box="string"==typeof c?a("#"+c):c,this.options=d||{},this._data=d.data,this.ajaxMode="string"==typeof this._data,this.data=this.ajaxMode?null:b.format(this._data),this.box.length&&(this.ajaxMode||this.data))if(this.ajaxMode){var e=this;b.ajax({url:this._data,tree:this,success:function(){e.init(null,!0)}})}else this.init(null,!0)}return b.key={},b.max=100,b.rootID=-1,b.ajax=function(c){c=c||{},a.getJSON(c.url,c.data,function(a){if(1==a.status){var d=c.tree;d&&a.data&&(d.data=b.format(a.data,d.data)),c.success&&c.success(a.data)}})},b.format=function(c,d){function e(a,c,d){var l,m,n,o,p,q=a.length,r=0;for(j++,l=0;q>l;l++)if(n=a[l],o=n[g.id],r++,void 0!=o&&!k[o]){if(k[o]=n,p=n[g.parent],void 0==p){k[o]={level:c};for(m in n)k[o][m]=m==f?[]:n[m];k[o][f]=k[o][f]||[],c>0&&(k[o][g.parent]=d,k[d][f].push(o)),n[f]&&n[f].length&&e(n[f],c+1,o)}else if(p==b.rootID)n.level=c=0,n[f]=[];else{if(n[f]=[],!k[p]){delete k[o],r--;continue}k[p][f]=k[p][f]||[],k[p][f].push(o),n.level=c=k[p].level+1}i[c]=i[c]||[],i[c].push(k[o])}2==h&&q>r&&3>j&&e(a)}var f,g,h=a.type(c),i=d&&d.level?d.level:[],j=0,k=d&&d.all?d.all:{};return b.key=g=a.extend({id:"id",name:"name",parent:"parent",children:"children",open:"open",link:"link"},b.key),f=g.children,"array"==h&&c.length&&"object"==a.type(c[0])?(h=void 0==c[0][g.parent]?1:2,e(c,0),{all:k,level:i}):{all:k,level:i}},b.parents=function(a,c,d){var e,f=b.key.parent,g=b.key.id,h=[];if(c=c||{},a=c[a],!a)return h;for(e=a[f];(e=c[e])&&(!d||!d(e));e=e[f])h.push(e[g]);return h},b.prototype={init:function(c,d){var e,f,g,h,i,j,k,l,m=this,n=b.key.link,o=b.key.id,p=b.key.open,q=b.key.name,r=(b.key.parent,b.key.children),s=void 0!=c&&c!=b.rootID,t=this.data.all,u=s?t[c].level+1:0,v=s?t[c][r]:this.data.level[u],w=this.options.isCheck,x="";if(v.length){for(v["break"]=v["break"]||0,e=v["break"];e<v.length;e++){if(e>=b.max+v["break"]){v["break"]+=b.max,x+='<li class="more"><a href="" pid="'+(s?c:b.rootID)+'" data-action="more" style="margin-left:'+15*u+'px">more</a></li>';break}if(g=v[e],g=s?t[g]:g,j=g[o],x+='<li level="'+u+'">',i="",u)for(f=0;u>f;f++)i+='<i class="line"></i>';h=g[n]?g[n]:"",k="undefined"!=typeof g[p]?'open="'+g[p]+'"':"",l=w?'<input type="checkbox" value="'+j+'" />':"",x+='<a class="item" href="'+h+'" reallink="'+h+'" id="'+j+'" '+k+">"+i+'<i class="ico"></i>'+l+'<i class="folder"></i><span class="text">'+g[q]+"</span></a>",g[r].length?(1==g[p]||m.options.openAll?(x+='<ul data-init="true">',x+=this.init(j,!1),g.init=!0):x+="<ul>",x+="</ul>"):this.ajaxMode&&(x+="<ul></ul>"),x+="</li>"}if(d){var y,z=this.box;s?(z=a(x),y=this.box.find("#"+c),y.next("ul").data("init",!0).append(z),this.addClass(y.parent())):(this.rootWrap||(this.rootWrap=a("<ul></ul>"),z.html(this.rootWrap),this.bind()),this.rootWrap.append(x),this.addClass(z,!0)),this.replaceLink(z),function(a){var b=a.find("a.item").not(".no_child");m.options.openAll&&(a.find("ul ul").show(),b.addClass("open")),b.filter(function(){return"0"==this.getAttribute("open")}).removeClass("open").next("ul").hide(),b.filter(function(){return"1"==this.getAttribute("open")}).addClass("open").next("ul").show()}(z),!s&&this.select(this.options.defaultNode)}return x}},bind:function(){var c,d,e,f=this;this.box.off("click.tree").on("click.tree",function(g){if(e=g.target,c=a(e),c.hasClass("ico")&&!c.parent().hasClass("no_child"))if(c=c.parent(".item"),d=c.next("ul"),c.hasClass("open"))d&&d.is(":visible")&&d.hide(),c.removeClass("open");else{if(!d.data("init")){var h=c[0].id;f.ajaxMode?b.ajax({url:f._data,data:{id:h},tree:f,success:function(a){a&&a.length?f.init(h,!0):(c.addClass("no_child").next("ul").remove(),c.find(".last_ico1").length&&c.find(".last_ico1").addClass("last_ico").removeClass("last_ico1")),d.data("init",!0)}}):(f.init(h,!0),d.data("init",!0))}d&&d.is(":hidden")&&d.show(),c.addClass("open")}else if(c.hasClass("folder")||c.hasClass("item")||c.hasClass("text")||c.hasClass("line")||c.hasClass("ico"))c.hasClass("item")||(c=c.parent()),f.box.find("a.current").removeClass("current"),c.addClass("current"),f.options.onSelect&&f.options.onSelect.call(f,f.data.all[c[0].id]);else{if("input"==e.tagName.toLowerCase()){var i,j,k,l=c.closest("a.item").next("ul").find("input"),m=c.parents("ul");if(e.checked){l.attr("checked","checked");for(var i=0;i<m.length;i++)j=m.eq(i),j.find("input").not(":checked").length||j.prev("a.item").find("input").attr("checked","checked")}else l.attr("checked",!1),m.prev("a.item").find("input").attr("checked",!1);return k=f.box.find(":checked"),f.checked=k.length?function(){var a=[];return k.each(function(){a.push(this.value)}),a}():null,f.options.onCheck&&f.options.onCheck.call(f,e.id),!0}"a"==e.tagName.toLowerCase()&&"more"==c.attr("data-action")&&(f.init(c.attr("pid"),!0),c.parent().remove())}return!1})},addClass:function(a,b){a=a||this.box;var c,d,e,f,g,h,i,j,k=a.find("a.item"),l=k.length;for(c=0;l>c;c++)if(g=k.eq(c),b&&0==c&&g.find(".ico").addClass("first_ico"),i=g.closest("li"),g.next("ul").length)for(!i.next().length&&g.find(".ico").addClass("last_ico1"),j=i.attr("level"),d=0;d<i.find("li").length;d++)for(h=i.find("li").eq(d).find(".line"),!i.next().length&&h.eq(j).addClass("last_line"),e=g.find(".last_line"),f=0;f<e.length;f++)h.eq(e.eq(f).index()).addClass("last_line");else!this.ajaxMode&&g.addClass("no_child"),i.next().length||g.find(".ico").addClass("last_ico")},select:function(a,c){function d(){return g.addClass("current"),f.options.onSelect&&f.options.onSelect.call(f,f.data.all[a]),!1}function e(a){0>a||(j=k.eq(a),j.show().siblings("a.item").addClass("open"),e(--a))}if(a){c=c||"id";var f=this,g=this.box.find("a["+c+'="'+a+'"]').eq(0),h=(b.key.parent,[]);if(this.data.all[a]){if(!g||!g.length){h=b.parents(a,this.data.all,function(a){return a.init});for(var i=h.length-1;i>=0;i--)this.init(h[i],!0);g=this.box.find("a["+c+'="'+a+'"]').eq(0)}if(this.box.find("a.current").removeClass("current"),g.parents("ul").first().is(":visible"))return d();var j,k=g.parents("ul").not(":visible"),l=k.length;e(l-1),d()}}},replaceLink:function(b){if(a.browser("ie6 ie7")){b=b||this.box;var c=b.find("a");c.each(function(){this.href=this.getAttribute("reallink",2),this.removeAttribute("reallink")})}}},b.select=function(c,d){function e(a){var c,d,e="";d=u[a],e='<select name="">',e+=s?'<option value="'+b.rootID+'">根目录</option>':o;for(c in d)v!=d[c][x]&&(e+=h(d[c],a));return e+="</select>"}function f(a){var b,c="";if(w++,a.length)for(b in a)c+=h(q.all[a[b]],w);return w--,c}function g(a){var b="--";for(i=0;a>i;i++)b+="--";return b}function h(a,b){return'<option value="'+(void 0!=a[x]?a[x]:"")+'">'+(s?g(b):"")+a[y]+"</option>"+(s?f(a[z]):"")}function j(){p=e(w),p=a(p),void 0!=r[0]&&(p[0].value=r[0],r[0]=null),c.html(p)}function k(a,c){b.ajax({url:d.data,data:a,success:function(d){if(d&&d.length){if(a&&a.id){var e,f=b.key.parent;for(e=0;e<d.length;e++)d[e][f]=a.id}q=b.format(d,q),u=q.level,c?c():(j(),!s&&n(p))}}})}function l(b,c){var d=q.all[c],e=d[z];e.length&&(b=a(b),d.init=!0,w=d.level,e=a('<select name="">'+o+f(e)+"</select>"),void 0!=r[w+1]&&(e[0].value=r[w+1],r[w+1]=null),b.after(e),n(e))}function m(b){var c=b.value;a(b).nextAll("select").remove(),c!=v&&q.all[c]&&(t&&!q.all[c].init?k({id:c},function(){l(b,c)}):l(b,c))}function n(a){a.change(function(){m(this)}),a.val()&&m(a[0])}d=d||{};var o,p,q="string"==typeof d.data?{}:b.format(d.data),r=[].concat(d.select),s=0==d.level,t="string"==typeof d.data,u=t?[]:q.level,v=void 0!=d.empty?d.empty:"",w=0,x=b.key.id,y=b.key.name,z=b.key.children;if(c&&c.length&&u)return o='<option value="'+v+'">请选择</option>',t?k():j(),s||p&&n(p),p},b}),define([],function(require,$){var codeLight=function(a){this.opt=a=a||{},this.parent=a.parent||"body",this.Box=null,this.code=null,this.init()};return codeLight.prototype={init:function(){function delLine(a){item=a.find(".rs_item li"),first=item.first(),last=item.last(),""==first.html().replace(/\s/g,"")&&first.remove(),""==last.html().replace(/\s/g,"")&&last.remove(),item=a.find(".rs_item li"),""==item.first().html().replace(/\s/g,"")&&delLine(a)}function delTab(a){if(first=a.first(),s.test(first.html())){var b,c,d=a.length;for(c=0;d>c;c++)b=a.eq(c),b.html(b.html().replace(s,""));s.test(first.html())&&delTab(a)}}function setKey(key,code){if(!key||!key.length)return code;for(var j=0;j<key.length;j++)code=code.replace(eval("/("+key[j]+")/g"),'<b class="key">$1</b>');return code}var m,code,box,type,C=this.parent.find("script[code]"),s=/\s{4}/,item,first,last,key;if(C.length)for(var i=0;i<C.length;i++)m=C.eq(i),type=m.attr("code"),key=m.attr("key"),key&&(key=key.split(",")),code=m.html()||m.val(),""!=code.replace(/\s/g,"")&&(code=this.str(code,type),code=setKey(key,code),m.css({display:"none"}).after('<pre title="双击编辑" class="codelight_box"><ol class="rs_item" tabindex="-1">'+code+'</ol><p class="open">+code</p></pre>'),box=m.next(".codelight_box"),box.find(".rs_item").on("dblclick",function(){return box.hasClass("code_hide")?!1:($(this).attr({contentEditable:!0}).addClass("edit"),void 0)}).on("blur",function(){$(this).removeAttr("contentEditable").removeClass("edit")}),box.find(".note .key").removeClass("key"),delLine(box),item=box.find(".rs_item li"),delTab(item),this.setOpt(box),m.remove())},str:function(a,b){var c={L:/</g,G:/>/g,L1:/(&lt;[\/]?)/g,G1:/&gt;/g,E:/\n/g,tab:/\t/g,htmlProperty:/(class|style|id|title|alt|src|align|href|rel|rev|name|target|content|http-equiv|onclick|onchange|onfocus|onmouseover|onmouseout|type|for|action|value)=/g,htmlTag:/(&lt;[\/]?)(html|body|title|head|meta|link|script|base|style|object|iframe|h1|h2|h3|h4|h5|h6|p|blockquote|pre|address|img|a|ol|div|ul|li|dl|dd|dt|ins|del|cite|q|fieldset|form|label|legend|input|button|select|textarea|table|caption|tbody|tfoot|thead|tr|td|th|span|strong|em|i|b|option)(\s|&gt;)/g,htmlNote:/(&lt;\!--([\s\S]*?)--&gt;)/gm,jsKey:/(var|new|function|return|this|if|else|do|while|for|true|false)([\s\({;.]+)/g,jsNote:/(\/\/.*)[\r\n]/g,jsNoteP:/(\/\*([\s\S]*?)\*\/)/gm,S:/&/g};return a=a.replace(c.S,"&amp;"),a=a.replace(c.L,"&lt;").replace(c.G,"&gt;"),"html"==b?(a=a.replace(c.htmlProperty,'<i class="property">$1</i>='),a=a.replace(c.htmlTag,'$1<i class="tag">$2</i>$3'),a=a.replace(c.htmlNote,'<i class="note">$1</i>'),a=a.replace(c.L1,'<i class="lt">$1</i>').replace(c.G1,'<i class="lt">&gt;</i>')):"javascript"==b&&(a=a.replace(/('[^'\\]*(?:\\[\s\S][^'\\]*)*'|"[^"\\]*(?:\\[\s\S][^"\\]*)*")/g,'<i class="note">$1</i>'),a=a.replace(c.jsKey,'<i class="jskey">$1</i>$2'),a=a.replace(c.jsNote,'<i class="note">$1</i></li><li>').replace(c.jsNoteP,'<i class="note">$1</i>')),a=a.replace(c.tab,"    "),a="<li>"+a.replace(c.E,"</li><li>"),a+="</li>"},setOpt:function(a){var b,c='<div class="set_opt">';c+='<a href="" class="hide">折叠</a>',c+="</div>",a.append(c),c=a.find(".set_opt"),b=c.find(".hide"),a.mouseover(function(){c.show()}).mouseout(function(){c.hide()}).click(function(a){var c=$(a.target);c.hasClass("open")&&b.click()}),b.click(function(){var b=$(this);return a.hasClass("code_hide")?(a.removeClass("code_hide").find(".open").hide(),b.html("折叠")):(a.addClass("code_hide").find(".open").show(),b.html("展开")),!1}),this.opt.autoHide&&a.find(".rs_item").height()>400&&b.click()}},codeLight}),define([],{nojs:{data:[{id:"nojs_info",text:"nojs简介",link:"index"},{id:"noJS",text:"noJS模块管理",open:1,data:[{id:"noJS_info",text:"使用介绍",link:"noJS/index"},{id:"noJS_config",text:"参数配置",link:"noJS/config"},{id:"noJS_module",text:"模块",link:"noJS/module"},{id:"noJS_api",text:"接口",link:"noJS/api"},{id:"noJS_pack",text:"打包上线",link:"noJS/pack"}]},{id:"nj_ui",text:"ui组件",open:1,data:[{id:"ui_info",text:"说明",link:"ui/index"},{id:"tools",text:"jQuery扩展工具",link:"ui/tools"},{id:"ui_core",text:"核心ui组件",open:0,data:[{id:"ui_setPos",text:"ui.setPos",link:"ui/setpos"},{id:"ui_layer",text:"ui.layer",link:"ui/layer"},{id:"ui_win",text:"ui.win",link:"ui/win"},{id:"ui_msg",text:"ui.msg",link:"ui/msg"},{id:"ui_select",text:"ui.select",link:"ui/select"},{id:"ui_switch",text:"ui.Switch",link:"ui/switch"},{id:"ui_slide",text:"ui.slide",link:"ui/slide"},{id:"ui_menu",text:"ui.menu",link:"ui/menu"},{id:"ui_ico",text:"ui.ico",link:"ui/ico"}]}]},{id:"other",text:"常用模块",open:1,data:[{id:"m_scroll",text:"scroll滚动",link:"module/scroll"},{id:"m_code",text:"code代码美化",link:"module/code"},{id:"drag",text:"drag",link:"module/drag"},{id:"form",text:"form表单验证",link:"module/form"},{id:"upload",text:"upload文件上传",link:"module/upload"},{id:"tree",text:"tree树形菜单",link:"module/tree"},{id:"color",text:"color取色器",link:"module/color"},{id:"face",text:"face表情选择",link:"module/face"},{id:"calendar",text:"calendar日历",link:"module/calendar"}]},{id:"test_page",text:"小测试",open:0,data:[{id:"impact",text:"html5碰撞小游戏",link:"test/impact"},{id:"imghot",text:"在线绘制图片热点",link:"test/imghot"}]}]},mobile:{data:[{id:"mb",text:"nojs.mobile",data:[{id:"mb_intro",text:"说明",link:"intro"},{id:"mb_ui",text:"ui",data:[{id:"mb_switch",text:"Switch选项卡",link:"switch"},{id:"mb_slide",text:"slide幻灯片",link:"slide"}]}]}]}});