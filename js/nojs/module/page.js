/*Thu Nov 14 2013 11:05:11 GMT+0800 (中国标准时间)-http://nolure.github.io/nojs.docs*/define("nojs/module/page",[],function(require,a){function b(b,c){this.element="string"==typeof b?a("#"+b):a(b),this.element&&this.element.length&&(this.options=c=c||{},this.count=this.element.data("count")||0,this.count&&(this.page=parseInt(c.page)||10,this.pages=Math.ceil(this.count/this.page),this.current=this.parse(c.current||1),this.length=this.parse(void 0==c.length?9:c.length),this.init(),"function"==typeof c.callback&&this.bind()))}return b.prototype={parse:function(a){return a>this.pages?this.pages:a},init:function(){var a,b,c,d,e,f,g,h,i,j="",k=this.length%2?Math.floor(this.length/2):this.length/2-1,l=this.current>k?this.current-k:1,m=l+this.length-1;for(m>this.pages&&(l=m-this.length+1,m=this.pages,m-l+1<this.length&&(l=m-this.length+1)),b=l;m>=b;b++)d=b==this.current?'class="current"':"",c=void 0==this.options.url?"?page="+b:this.options.url.replace(/{page}/,b),j+='<a href="'+c+'" '+d+' class="item">'+b+"</a>";e='class="first'+(1==this.current?" disabled":"")+'"',f='<a href="" data-page="1" '+e+">首页</a>",e='class="prev'+(this.current<=1?" disabled":"")+'"',g='<a href="" data-page="'+(this.current>1?this.current-1:1)+'" '+e+">上一页</a>",e='class="next'+(this.current>=this.pages?" disabled":"")+'"',h='<a href="" data-page="'+(this.current<this.pages?this.current+1:this.pages)+'" '+e+">下一页</a>",e='class="last'+(this.current==this.pages?" disabled":"")+'"',i='<a href="" data-page="'+this.pages+'" '+e+">尾页</a>",a=[f,g,j,h,i,'<span class="page">'+this.current+"/"+this.pages+"页</span>",'<span class="count">共'+this.count+"条记录</span>"].join(""),this.element.html(a)},bind:function(){var b,c,d=this;this.element.click(function(e){return"a"==e.target.tagName.toLowerCase()?(c=a(e.target),b=parseInt(c.text()),c.data("page")&&(b=c.data("page")),d.current!=b&&(d.current=b,d.init(),d.options.callback.call(d)),!1):void 0})}},b});