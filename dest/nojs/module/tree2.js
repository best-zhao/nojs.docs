/*nolure@vip.qq.com http://nolure.github.io/nojs.docs*/define("nojs/module/tree2",[],function(require,a){return function(b,c,d){function e(b){function e(b,c){var d,f,g,h,i,m,n,o,p=b.length;for(j+="<ul>",d=0,k=c;p>d;d++){if(j+='<li level="'+(c+1)+'">',h=b[d],h&&h.text){if(i=h.link?h.link:"",m="",c)for(f=0;c>f;f++)m+='<i class="line"></i>';n="undefined"!=typeof h.id?'id="'+h.id+'"':"",o="undefined"!=typeof h.open?'open="'+h.open+'"':"",j+='<a class="item" href="'+i+'" reallink="'+i+'" '+n+" "+o+">"+m+'<i class="ico"></i><i class="folder"></i><span class="text">'+h.text+"</span></a>",l.length++;for(f in h)if(g=h[f],"array"==a.type(g)&&g.length){k=c,e(g,++k);break}}j+="</li>"}j+="</ul>",k=0}c=b||c,j="",e(c,0),i.html(j).show(),!function(){if(a.browser("ie6 ie7")){var b=i.find("a");b.each(function(){this.href=this.getAttribute("reallink",2),this.removeAttribute("reallink")})}}(),g(),function(){var a=i.find("a.item").not(".no_child");d.openAll&&(i.find("ul ul").show(),a.addClass("open")),a.filter(function(){return"0"==this.getAttribute("open")}).removeClass("open").next("ul").hide(),a.filter(function(){return"1"==this.getAttribute("open")}).addClass("open").next("ul").show()}(),f(d.defaultNode)}function f(a,b){function c(){return f.addClass("current"),d.onSelect&&d.onSelect.call(l,a,f.attr("href")),!1}function e(a){0>a||(g=h.eq(a),g.show().siblings(".item").addClass("open"),e(--a))}b=b||"id";var f="undefined"!=typeof a?i.find("a["+b+'="'+a+'"]').eq(0):i.find("a.current:first");if(f.length){if(i.find(".current").removeClass("current"),f.parents("ul").first().is(":visible"))return c();var g,h=f.parents("ul").not(":visible"),j=h.length;e(j-1),c()}}function g(){var a,b,c,d,e,f=i.find(".item"),g=f.length;for(a=0;g>a;a++)if(c=f.eq(a),0==a&&c.find(".ico").addClass("first_ico"),d=c.parents("li").eq(0),c.next("ul").length){if(!d.next().length)for(c.find(".ico").addClass("last_ico1"),e=d.attr("level"),b=0;b<d.find("li").length;b++)d.find("li").eq(b).find(".line").eq(e-1).addClass("last_line")}else c.addClass("no_child"),d.next().length||c.find(".ico").addClass("last_ico")}function h(b){a("#"+b).find("i.ico").click()}if(b&&"array"===a.type(c)&&c.length){d=d||{};var i=a("#"+b),j="",k=0,l={init:e,box:i,setNode:f,length:0,open:h};if(i.length)return e(),function(){var b,c;i.on("click",function(e){return b=a(e.target),b.hasClass("ico")&&!b.parent().hasClass("no_child")?(b=b.parent(".item"),c=b.next("ul"),b.hasClass("open")?(c&&c.is(":visible")&&c.hide(),b.removeClass("open")):(c&&c.is(":hidden")&&c.show(),b.addClass("open"))):(b.hasClass("folder")||b.hasClass("item")||b.hasClass("text")||b.hasClass("line"))&&(!b.hasClass("item")&&(b=b.parent(".item")),i.find(".current").removeClass("current"),b.addClass("current"),d.onSelect&&d.onSelect.call(l,b.attr("id"),b.attr("href"))),!1})}(),l}}});